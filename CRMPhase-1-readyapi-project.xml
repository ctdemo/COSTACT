<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="8ea453f3-9959-4208-9599-a095eb2b5c67" created="3.0.0" activeEnvironment="Default environment" name="CRMPhase-1" resourceRoot="" updated="3.3.2 2020-08-19T12:03:33Z" encryptionMode="Not encrypted" abortOnError="false" runType="SEQUENTIAL" soapui-version="5.5.0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings/>
  <con:interface xsi:type="con:RestService" id="de75b990-2b8b-460f-8e2f-c1105f49846d" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints>
      <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:endpoints>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="Activate" path="/card/${DataSource#Input}/activate" id="9a1a4513-0f4b-4a01-b435-d818104a9801">
      <con:settings/>
      <con:parameters/>
      <con:method name="Activate" id="4df7c972-6e79-4214-9178-89c4690e2bb2" method="POST">
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>cardNumber</con:name>
            <con:value>cardNumber</con:value>
            <con:style>TEMPLATE</con:style>
            <con:default>cardNumber</con:default>
            <con:path xsi:nil="true"/>
            <con:description xsi:nil="true"/>
          </con:parameter>
        </con:parameters>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>401 404 500 400</con:status>
          <con:params/>
          <con:element xmlns:act="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/63378092906500241233/activate">act:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>201</con:status>
          <con:params/>
          <con:element xmlns:act="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/63378092906500241233/activate">act:Response</con:element>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/x-www-form-urlencoded</con:mediaType>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="5c61b4cf-57a8-4fcc-9fc7-02b713fee8c8" mediaType="application/json" postQueryString="false">
          <con:settings/>
          <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters>
            <con:entry key="cardNumber" value="cardNumber"/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>cardNumber</con:entry>
          </con:parameterOrder>
          <con:environmentSpec>
            <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="587f2efe-93d3-41cb-ad65-7d634b8fa756" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 1" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints>
      <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:endpoints>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="Cards" path="customer/${DataSource#email}/cards" id="23953531-fc57-4159-9ac6-ed374fcc924f">
      <con:settings/>
      <con:parameters/>
      <con:method name="Cards" id="93eea6bd-d631-4aeb-9891-43a01db5d4d1" method="GET">
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>email</con:name>
            <con:value>email</con:value>
            <con:style>TEMPLATE</con:style>
            <con:default>email</con:default>
            <con:path xsi:nil="true"/>
            <con:description xsi:nil="true"/>
          </con:parameter>
        </con:parameters>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>404 400 401</con:status>
          <con:params/>
          <con:element xmlns:car="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/vamshi.naroju@whishworks.com/cards">car:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:car="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/vamshi.naroju@whishworks.com/cards">car:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType xsi:nil="true"/>
          <con:status>400</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:request name="Request 1" id="eb05d101-4ef2-41e2-869e-31d31475e30b" mediaType="application/json">
          <con:settings/>
          <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters>
            <con:entry key="email" value="email"/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>email</con:entry>
          </con:parameterOrder>
          <con:environmentSpec>
            <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="8a174de8-9237-4691-8902-7f2ac7429789" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 2" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints>
      <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:endpoints>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="Points" path="/card/${DataSource#CardNumber}/points" id="5a4ae59d-886c-4363-9337-5399a3d595aa">
      <con:settings/>
      <con:parameters/>
      <con:method name="Points" id="6f511c13-4b68-4029-87f7-aa14cacea4fe" method="PUT">
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>cardNumber</con:name>
            <con:value>cardNumber</con:value>
            <con:style>TEMPLATE</con:style>
            <con:default>cardNumber</con:default>
            <con:path xsi:nil="true"/>
            <con:description xsi:nil="true"/>
          </con:parameter>
        </con:parameters>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>500 400 404 415 422</con:status>
          <con:params/>
          <con:element xmlns:poin="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6/points">poin:Fault</con:element>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:poin="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337800760710204622306/points">poin:Response</con:element>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/jsonaaaa</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/xml</con:mediaType>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="25812199-9233-4a98-9330-344c2ee8d229" mediaType="application/json" postQueryString="false">
          <con:settings/>
          <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters>
            <con:entry key="cardNumber" value="cardNumber"/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>cardNumber</con:entry>
          </con:parameterOrder>
          <con:environmentSpec>
            <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="d5b1cfd4-6ba6-4980-9b7a-05c9ae8ed919" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 3" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints>
      <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:endpoints>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="Transactions" path="/card/${DataSource#cardNumber}/transactions" id="159e7cb6-014d-4e29-a2e6-521704c93bc5">
      <con:settings/>
      <con:parameters/>
      <con:method name="Transactions" id="338c254f-a01d-472e-8ad0-0a8a1deaa6a0" method="GET">
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>cardNumber</con:name>
            <con:value>cardNumber</con:value>
            <con:style>TEMPLATE</con:style>
            <con:default>cardNumber</con:default>
            <con:path xsi:nil="true"/>
            <con:description xsi:nil="true"/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>offset</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>limit</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>dateFrom</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>dateTo</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>type</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>site</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>status</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>channel</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>sort</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
        </con:parameters>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:tran="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337804318710200046432/transactions">tran:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>400 404 401 500</con:status>
          <con:params/>
          <con:element xmlns:tran="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337804318710200046432/transactions">tran:Fault</con:element>
        </con:representation>
        <con:request name="Request 1" id="874be363-c06a-4af3-b56e-cdb59ace5be1" mediaType="application/json">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="99999999"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
          </con:settings>
          <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
          <con:request/>
          <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6/transactions</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters>
            <con:entry key="site" value="2"/>
            <con:entry key="offset" value="12"/>
            <con:entry key="limit" value="1"/>
            <con:entry key="dateTo" value="q"/>
            <con:entry key="channel" value="7"/>
            <con:entry key="sort" value="j"/>
            <con:entry key="dateFrom" value="2"/>
            <con:entry key="type" value="1"/>
            <con:entry key="status" value="1"/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>cardNumber</con:entry>
            <con:entry>offset</con:entry>
            <con:entry>limit</con:entry>
            <con:entry>dateFrom</con:entry>
            <con:entry>dateTo</con:entry>
            <con:entry>type</con:entry>
            <con:entry>site</con:entry>
            <con:entry>status</con:entry>
            <con:entry>channel</con:entry>
            <con:entry>sort</con:entry>
          </con:parameterOrder>
          <con:environmentSpec>
            <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:interface xsi:type="con:RestService" id="59e975f5-8605-4c91-9796-55adb7825dc7" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 4" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache/>
    <con:endpoints>
      <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:endpoints>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
    <con:resource name="Transactions" path="/customer/${DataSource#email}/transactions" id="eb7671de-49ae-4f51-ab52-e81ddc0b1697">
      <con:settings/>
      <con:parameters/>
      <con:method name="Transactions" id="735edaf5-6357-447a-bbca-0f803f008c0b" method="GET">
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>email</con:name>
            <con:value>email</con:value>
            <con:style>TEMPLATE</con:style>
            <con:default>email</con:default>
            <con:path xsi:nil="true"/>
            <con:description xsi:nil="true"/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>offset</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>limit</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>dateFrom</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>dateTo</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>type</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>site</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>status</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>channel</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
          <con:parameter required="true">
            <con:name>sort</con:name>
            <con:value/>
            <con:style>QUERY</con:style>
            <con:default/>
          </con:parameter>
        </con:parameters>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>404 400</con:status>
          <con:params/>
          <con:element xmlns:tran="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/transactions">tran:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:tran="https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/transactions">tran:Response</con:element>
        </con:representation>
        <con:request name="Request 1" id="c1ed625e-8c29-4f20-b782-7f3c0b7072c0" mediaType="application/json">
          <con:settings/>
          <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters>
            <con:entry key="email" value="email"/>
          </con:parameters>
          <con:parameterOrder>
            <con:entry>email</con:entry>
            <con:entry>offset</con:entry>
            <con:entry>limit</con:entry>
            <con:entry>dateFrom</con:entry>
            <con:entry>dateTo</con:entry>
            <con:entry>type</con:entry>
            <con:entry>site</con:entry>
            <con:entry>status</con:entry>
            <con:entry>channel</con:entry>
            <con:entry>sort</con:entry>
          </con:parameterOrder>
          <con:environmentSpec>
            <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
              <con:authProfile>Inherit From Parent</con:authProfile>
            </con:entry>
          </con:environmentSpec>
        </con:request>
        <con:environmentSpec>
          <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:method>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:resource>
  </con:interface>
  <con:testSuite id="727bb2ad-71d0-4f3f-bb29-ee129bd55557" name="ActivateCards">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="45e1d859-c5df-418d-ac71-8de962711319" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="BMO" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="5ea4c875-1386-402c-a7ff-f18f49c7414f">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\ActivateCards.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="3cb9a9fe-46e8-4d00-a25b-21b9c2c179c6">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>BMO</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>Input</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="6b3ad994-aed8-4077-9e95-e050a8a7d0cf">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="9c885f00-8bb0-4045-b388-81e8f807c262">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io" resourcePath="/card/${DataSource#Input}/activate" methodName="Activate" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="5c61b4cf-57a8-4fcc-9fc7-02b713fee8c8" mediaType="application/x-www-form-urlencoded" postQueryString="true">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="234234234243"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/63378092906500241233/activate</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="63378095037500227046"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="b455f0b8-11f6-4cb1-948b-bf4ad98ba351">
        <con:settings/>
        <con:config>
          <script>import groovy.json.JsonSlurper

//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//Get the status code value from the Input sheet
def status_Code = context.expand( '${DataSource#Status_Code}' )

//Assert actual value to the expected value
if (status.contains(status_Code))
{
return "PASS"
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="4a7491d9-a922-4433-a33c-0319755bc38d">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>BMO</worksheet>
              <cell>C2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="500934ce-6fd9-4eef-b494-fbd7651282e0">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="e7e91879-6a45-41bb-9679-3e0fb7cc4c81" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="MM" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="01d636c4-3f48-42ac-b8ab-19f5a475119b">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\ActivateCards.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="a4752183-be5c-4e41-94ea-716759529901">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>MM</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>Input</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:property>Exception Code</con:property>
          <con:property>Message</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="7a3b8b63-119d-4445-b541-eba28a0dbf4d">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="06d6d560-1a2e-4101-813b-dbf8cc0c2a6b">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io" resourcePath="/card/${DataSource#Input}/activate" methodName="Activate" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="5c61b4cf-57a8-4fcc-9fc7-02b713fee8c8" mediaType="application/x-www-form-urlencoded" postQueryString="true">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="234234234243"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#Input}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="0cc7dfb8-f2c7-4605-a4bf-0e296b338d69">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="6f98ba08-18fb-48e2-9822-353aca1301aa">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>MM</worksheet>
              <cell>C2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="4ed24955-4cf4-4e0f-9d1c-e3269a7f9728">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="3988895e-41d2-415d-b2f3-40b8f65b9215" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="ID" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="e7122408-f8bc-4283-8966-5c6886ec5a19">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\ActivateCards.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="d0c5b050-4d5c-4f72-b699-d36019e03a76">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>ID</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>Input</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:property>Exception Code</con:property>
          <con:property>Message</con:property>
          <con:property>Remarks</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="51531914-e597-46cc-83f9-4601ac75426e">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="7e917c07-aee5-4662-ba47-d77060130110">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io" resourcePath="/card/${DataSource#Input}/activate" methodName="Activate" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="5c61b4cf-57a8-4fcc-9fc7-02b713fee8c8" mediaType="application/x-www-form-urlencoded" postQueryString="true">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="234234234243"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/63378092906500200000/activate</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#Input}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="400181d2-8f38-454c-8855-7e9b4d6cecf3">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="f4e82c79-d4ec-4b2f-9fb5-01b8980ed582">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>ID</worksheet>
              <cell>C2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="64a9a9d8-40b7-496d-8291-53955890daf2">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="e9c34198-a592-4cb4-a5f5-2825278ce136" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="Headers" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="34dbff7f-ccd6-41e2-af54-386082fb929a">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\ActivateCards.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="03fd67d0-e71d-4ac9-8216-1daf24c2e483">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>Headers</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>Input</con:property>
          <con:property>X-COSTA-LANG</con:property>
          <con:property>X-COSTA-COUNTRY</con:property>
          <con:property>X-COSTA-CHANNEL</con:property>
          <con:property>X-COSTA-ORGANISATION</con:property>
          <con:property>client_id</con:property>
          <con:property>client_secret</con:property>
          <con:property>StatusCode</con:property>
          <con:property>ExceptionCode</con:property>
          <con:property>Message</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="c7a7e7a7-d58a-4d78-b934-6681ed472d1f">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="1fe0e84e-f78d-4229-a5f3-d81bca7b8335">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io" resourcePath="/card/${DataSource#Input}/activate" methodName="Activate" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="5c61b4cf-57a8-4fcc-9fc7-02b713fee8c8" mediaType="application/x-www-form-urlencoded" postQueryString="true">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="${DataSource#X-COSTA-COUNTRY}"/>
  <con:entry key="X-COSTA-CHANNEL" value="${DataSource#X-COSTA-CHANNEL}"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="123"/>
  <con:entry key="client_secret" value="${DataSource#client_secret}"/>
  <con:entry key="X-COSTA-LANG" value="${DataSource#X-COSTA-LANG}"/>
  <con:entry key="client_id" value="${DataSource#client_id}"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/activate</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#Input}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="738c8e47-4afd-4ac3-a6cc-cfeda8a0dbc5">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="be9c3d8c-e1fa-44ed-a943-43ec6451fd65">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>Headers</worksheet>
              <cell>L2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="121928d6-eb85-41fb-9df9-1cd928621f91">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="fb2d8dc8-b45c-446b-85bc-37dc0d376d0e" name="GetCards">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="0fb8e64d-2532-4ded-8f70-4d15c929d7a3" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="BMO" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="ba88cf57-8c52-4e2b-9534-cd9683ff59ac">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetCards.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="36768a3b-8a4f-4dc1-9b33-0c76a7681da4">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>BMO</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>email</con:property>
          <con:property>X-COSTA-LANG</con:property>
          <con:property>X-COSTA-COUNTRY</con:property>
          <con:property>X-COSTA-CHANNEL</con:property>
          <con:property>X-COSTA-ORGANISATION</con:property>
          <con:property>client_id</con:property>
          <con:property>client_secret</con:property>
          <con:property>StatusCode</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="ff41540f-d6b9-4043-a0fb-49354c4725fb">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="ba7dadda-645f-40b9-b86c-d0c113a00edf">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 1" resourcePath="/customer/${DataSource#email}/cards" methodName="Cards" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="eb05d101-4ef2-41e2-869e-31d31475e30b" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="${DataSource#X-COSTA-COUNTRY}"/>
  <con:entry key="X-COSTA-CHANNEL" value="${DataSource#X-COSTA-CHANNEL}"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="123"/>
  <con:entry key="client_secret" value="${DataSource#client_secret}"/>
  <con:entry key="X-COSTA-LANG" value="${DataSource#X-COSTA-LANG}"/>
  <con:entry key="client_id" value="${DataSource#client_id}"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/vamshi.naroju@whishworks.com/cards</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="email" value="${DataSource#email}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>email</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="f7232c93-640d-458d-bd97-2e3025497933">
        <con:settings/>
        <con:config>
          <script>import groovy.json.JsonSlurper

//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//Get the status code value from the Input sheet
def status_Code = context.expand( '${DataSource#StatusCode}' )
 

//Assert actual value to the expected value
if (status.contains(status_Code))
{
return "PASS"
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="4ae55729-6704-43bb-b58e-2e9bd908eaaf">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>BMO</worksheet>
              <cell>J2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="6383e050-ee7c-4586-946c-23672ca63137">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="e299b899-7e6a-416f-96d3-7ad2cf692ab1" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="ID" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="b0381b81-c633-4d32-a5e8-0a6f3dd5f695">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetCards.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="6359b529-768e-4ae7-b04c-8dea62444d97">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>ID</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>email</con:property>
          <con:property>X-COSTA-LANG</con:property>
          <con:property>X-COSTA-COUNTRY</con:property>
          <con:property>X-COSTA-CHANNEL</con:property>
          <con:property>X-COSTA-ORGANISATION</con:property>
          <con:property>client_id</con:property>
          <con:property>client_secret</con:property>
          <con:property>StatusCode</con:property>
          <con:property>ExceptionCode</con:property>
          <con:property>Message</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="fef3f43c-cc29-49df-b2af-dd38cb14fb02">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="8440c7a8-1147-4c16-9bbc-b8d3a4a72051">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 1" resourcePath="/customer/${DataSource#email}/cards" methodName="Cards" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="eb05d101-4ef2-41e2-869e-31d31475e30b" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="${DataSource#X-COSTA-COUNTRY}"/>
  <con:entry key="X-COSTA-CHANNEL" value="${DataSource#X-COSTA-CHANNEL}"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="1233"/>
  <con:entry key="client_secret" value="${DataSource#client_secret}"/>
  <con:entry key="X-COSTA-LANG" value="${DataSource#X-COSTA-LANG}"/>
  <con:entry key="client_id" value="${DataSource#client_id}"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/11vamshi.naroju@whishworks.com/cards</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="email" value="${DataSource#email}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>email</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="3de46024-5d3c-4aeb-9d15-d2a4afb16858">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="ae19584d-ccd4-4d06-a013-644e2940f90f">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>ID</worksheet>
              <cell>L2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="fe93adb7-3017-4966-bef3-a9445df2f505">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="b27c3cdc-f142-4896-9315-3d65b28d9391" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="Headers" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="3f3d44e0-071f-460c-b795-a05cdb502d5c">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetCards.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="b07e8f72-5b63-4449-8f32-0c24f87ae007">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>Headers</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>email</con:property>
          <con:property>X-COSTA-LANG</con:property>
          <con:property>X-COSTA-COUNTRY</con:property>
          <con:property>X-COSTA-CHANNEL</con:property>
          <con:property>X-COSTA-ORGANISATION</con:property>
          <con:property>X-COSTA-API-VERSION</con:property>
          <con:property>client_id</con:property>
          <con:property>client_secret</con:property>
          <con:property>StatusCode</con:property>
          <con:property>ExceptionCode</con:property>
          <con:property>Message</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="a585a2f8-8707-494a-af43-a818f04efb60">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="91781771-f0fe-4d6e-affd-e3f85371609a">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 1" resourcePath="/customer/${DataSource#email}/cards" methodName="Cards" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="eb05d101-4ef2-41e2-869e-31d31475e30b" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="${DataSource#X-COSTA-COUNTRY}"/>
  <con:entry key="X-COSTA-CHANNEL" value="${DataSource#X-COSTA-CHANNEL}"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="111111111"/>
  <con:entry key="client_secret" value="${DataSource#client_secret}"/>
  <con:entry key="X-COSTA-LANG" value="${DataSource#X-COSTA-LANG}"/>
  <con:entry key="client_id" value="${DataSource#client_id}"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/vamshi.naroju@whishworks.com/cards</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="email" value="${DataSource#email}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>email</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="cd10a726-1068-4d1b-b08e-233ec04e7de5">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="e9879aa0-08aa-4df9-b0db-54547c7f4332">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>Headers</worksheet>
              <cell>M2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="e15eca3c-e311-4552-b6a4-f1eb276f6843">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="02420e3c-cd37-4fa7-920b-663f6acd7f4f" name="UpdateLoyaltyPoints">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="ac969a93-c695-4d3d-901a-01f6f78ed3fc" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="BMO" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="3f2b3b3e-bb3f-4fa8-87e6-27f42d79f70b">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\PUT.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="d1e987a1-d8fd-438d-83b3-4e70904743d2">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>BMO</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>CardNumber</con:property>
          <con:property>StoreID</con:property>
          <con:property>loyaltyTransactionId</con:property>
          <con:property>cashierId</con:property>
          <con:property>transactionDateTime</con:property>
          <con:property>tillVersion</con:property>
          <con:property>tillType</con:property>
          <con:property>tillId</con:property>
          <con:property>pointsAmount</con:property>
          <con:property>CRMNumber</con:property>
          <con:property>pointsType</con:property>
          <con:property>pointsCorrectionReason</con:property>
          <con:property>comment</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaleTransactionCode" id="d9076282-11d1-46c0-9d1c-30a7edfc096d">
        <con:settings/>
        <con:config>
          <script>//generate random numbers
Random random = new Random();
      
 for(int i =1; i&lt;1000000; i++){
      int randomInteger =Math.abs( random.nextInt());
      log.info("Random Integer in Java: " + randomInteger);
       return randomInteger +"122223"
 }</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="5d650834-3fdd-4ec0-8596-6c59694e5cb8">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="d8cb60f3-194b-473a-95b9-e80469a3d002">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 2" resourcePath="/card/${DataSource#CardNumber}/points" methodName="Points" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="25812199-9233-4a98-9330-344c2ee8d229" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-SUB-CHANNEL" value="X-CLT-TA"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="11111111"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request>{
  "storeId": "${DataSource#StoreID}",
  "saleTransactionCode": "${SaleTransactionCode#result}",
  "transactionDateTime": "${DataSource#transactionDateTime}",
  "cashierId": ${DataSource#cashierId},
  "tillVersion": "${DataSource#tillVersion}",
  "tillType": "${DataSource#tillType}",
  "tillId": "${DataSource#tillId}",
  "pointsAmount": ${DataSource#pointsAmount},
  "CRMNumber" : "${DataSource#CRMNumber}",
  "pointsType" : "${DataSource#pointsType}",
  "pointsCorrectionReason" :"${DataSource#pointsCorrectionReason}",
  "comments" : "${DataSource#comment}"
}</con:request>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337800760710204622306/points</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#CardNumber}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="afda8dbc-0e83-4aaa-a286-63367280505e">
        <con:settings/>
        <con:config>
          <script>import groovy.json.JsonSlurper

//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//Get the status code value from the Input sheet
def status_Code = context.expand( '${DataSource#Status_Code}' )

 

//Assert actual value to the expected value
if (status.contains(status_Code))
{
return "PASS"
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="b8375ed3-320c-4c21-9756-e968a41d438c">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>BMO</worksheet>
              <cell>N2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="4d0801c2-e2e0-4fea-a456-3172d1049a5c">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>SaleTransactionCode</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d8cb60f3-194b-473a-95b9-e80469a3d002</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="ebcddf4e-e1e4-46d8-a7fb-18ac8f53f66a" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="MO" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="26848e3a-a3ee-4c6b-97ff-3b9e96426c68">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\PUT.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="296794a2-4072-480f-9cb5-1310735f57e4">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>MO</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>CardNumber</con:property>
          <con:property>StoreID</con:property>
          <con:property>loyaltyTransactionId</con:property>
          <con:property>cashierId</con:property>
          <con:property>transactionDateTime</con:property>
          <con:property>tillVersion</con:property>
          <con:property>tillType</con:property>
          <con:property>tillId</con:property>
          <con:property>pointsAmount</con:property>
          <con:property>CRMNumber</con:property>
          <con:property>pointsType</con:property>
          <con:property>pointsCorrectionReason</con:property>
          <con:property>comment</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaleTransactionCode" id="e4b4e6b8-6179-4f84-8849-0c06b4806f25">
        <con:settings/>
        <con:config>
          <script>//generate random numbers
Random random = new Random();
      
 for(int i =1; i&lt;1000000; i++){
      int randomInteger =Math.abs( random.nextInt());
      log.info("Random Integer in Java: " + randomInteger);
       return randomInteger +"122223"
 }</script>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="300743b2-34b1-4dfd-9a47-65b739c42db1">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="eb2f3c22-6162-442e-9811-beee991e909a">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 2" resourcePath="/card/${DataSource#CardNumber}/points" methodName="Points" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="25812199-9233-4a98-9330-344c2ee8d229" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-SUB-CHANNEL" value="X-CLT-TA"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="12313"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request>{
  "storeId": "${DataSource#StoreID}",
  "saleTransactionCode": "${SaleTransactionCode#result}",
  "transactionDateTime": "${DataSource#transactionDateTime}",
  "cashierId": ${DataSource#cashierId},
  "tillVersion": "${DataSource#tillVersion}",
  "tillType": "${DataSource#tillType}",
  "tillId": "${DataSource#tillId}",
  "pointsAmount": ${DataSource#pointsAmount},
  "CRMNumber" : "${DataSource#CRMNumber}",
  "pointsType" : "${DataSource#pointsType}",
  "pointsCorrectionReason" :"${DataSource#pointsCorrectionReason}",
  "comments" : "${DataSource#comment}"
}</con:request>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337804318710200046432/points</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#CardNumber}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="bb072fe0-7572-4182-9518-e4ef7f7cbae2">
        <con:settings/>
        <con:config>
          <script>import groovy.json.JsonSlurper

//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//Get the status code value from the Input sheet
def status_Code = context.expand( '${DataSource#Status_Code}' )


 

//Assert actual value to the expected value
if (status.contains(status_Code))
{
return "PASS"
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="afd5ce41-d318-4000-b07f-787f42398558">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>MO</worksheet>
              <cell>N2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="9f1a1eae-bc14-4cd7-b371-f2bf69846f02">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>SaleTransactionCode</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d8cb60f3-194b-473a-95b9-e80469a3d002</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>e4b4e6b8-6179-4f84-8849-0c06b4806f25</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="a151281c-2d47-4788-8a46-7e0ed74b0a37" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="MM" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="206bccca-7dd8-4a21-b1c8-8caf24742494">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\PUT.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="cdb0bf5c-f03a-4a00-9590-f75b5b162693">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>MM</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>CardNumber</con:property>
          <con:property>Input</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:property>Exception Code</con:property>
          <con:property>Message</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="88bcf7e2-adda-4e35-9069-f7b91166e668">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="0491a1ad-84a1-4d79-aeaa-d660e5d1976d">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 2" resourcePath="/card/${DataSource#CardNumber}/points" methodName="Points" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="25812199-9233-4a98-9330-344c2ee8d229" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-SUB-CHANNEL" value="X-CLT-TA"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="1111111111"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request>${DataSource#Input}</con:request>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337804318710200046432/points</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#CardNumber}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="0e768f78-2d90-4f64-9114-4445360f6e1e">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="13090620-c11f-4c60-bc01-7825bbcb877e">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>MM</worksheet>
              <cell>C2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="b2b1d130-6af2-43f3-b28b-44414e00e7c1">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d8cb60f3-194b-473a-95b9-e80469a3d002</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="7c359f44-e838-4815-b135-4bd4c8e65c56" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="ID" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="f94a971f-d6cb-4f9a-910c-ddd0ac19295a">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\PUT.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="000c1e50-227d-4308-b972-0065e7a7d984">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>ID</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>CardNumber</con:property>
          <con:property>Input</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:property>Exception Code</con:property>
          <con:property>Message</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="5f199730-77ef-4a3b-a5e9-fbc9a460f08c">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="f9b30c72-7e8f-4586-97b9-8575126ffa1f">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 2" resourcePath="/card/${DataSource#CardNumber}/points" methodName="Points" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="25812199-9233-4a98-9330-344c2ee8d229" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-SUB-CHANNEL" value="X-CLT-TA"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="66666666666666"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request>${DataSource#Input}</con:request>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6/points</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#CardNumber}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="2acace2e-9630-48ab-8215-8b80bcdbcef5">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="d0888e63-f669-491c-a986-a7f24ecac114">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>ID</worksheet>
              <cell>C2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="aaf18a2f-d594-4a9e-a6c7-15eb7d7e4f07">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d8cb60f3-194b-473a-95b9-e80469a3d002</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="5e259f06-b89a-4b36-923e-c884254f6243" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="Headers" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="d2432bed-39c2-4497-91c9-5395891928dc">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\PUT.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="f1a7b8e7-1a19-46c5-aa9e-20ac63257a7a">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>Headers</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>CardNumber</con:property>
          <con:property>Input</con:property>
          <con:property>X-COSTA-LANG</con:property>
          <con:property>X-COSTA-COUNTRY</con:property>
          <con:property>X-COSTA-CHANNEL</con:property>
          <con:property>X-COSTA-ORGANISATION</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>contentType</con:property>
          <con:property>X-COSTA-TRANSACTION-ID</con:property>
          <con:property>X-COSTA-SUB-CHANNEL</con:property>
          <con:property>Result</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>CorrelationID</con:property>
          <con:property>Status_Code</con:property>
          <con:property>Exception Code</con:property>
          <con:property>Message</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="b202745b-0f60-44ec-88e2-fc9becf6d4db">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="e6f90aff-0eb1-46a9-a3ed-11d75ba4a7a2">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 2" resourcePath="/card/${DataSource#CardNumber}/points" methodName="Points" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="25812199-9233-4a98-9330-344c2ee8d229" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="${DataSource#X-COSTA-COUNTRY}"/>
  <con:entry key="X-COSTA-CHANNEL" value="${DataSource#X-COSTA-CHANNEL}"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-SUB-CHANNEL" value="${DataSource#X-COSTA-SUB-CHANNEL}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="111111111111"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="${DataSource#X-COSTA-LANG}"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
  <con:entry key="Content-Type" value="${DataSource#contentType}"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request>${DataSource#Input}</con:request>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337800760710204622306/points</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="cardNumber" value="${DataSource#CardNumber}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="2b53a195-5eda-4fd7-93c2-ccf029cda260">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="e23d8200-1d3a-431b-97c5-9c478ef03c5b">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>Headers</worksheet>
              <cell>M2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>CorrelationID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="523acef5-84cc-4069-a240-9de0cbf11558">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>d8cb60f3-194b-473a-95b9-e80469a3d002</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="ece3949c-d4b4-4898-9607-8b48380ec2bd" name="GetHistoryByCardNumber">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="cabe911a-003f-44ee-a389-084006fd44c7" discardOkResults="false" failOnError="false" failTestCaseOnErrors="true" keepSession="false" name="BMO" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="49ba35e8-d58a-4521-b1de-9e3c8f8f1288">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetHistory-cardnumber.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="0c42c22f-22dc-4531-b9aa-74f2122c342f">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>BMO</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>cardNumber</con:property>
          <con:property>offset</con:property>
          <con:property>limit</con:property>
          <con:property>dateFrom</con:property>
          <con:property>dateTo</con:property>
          <con:property>type</con:property>
          <con:property>site</con:property>
          <con:property>status</con:property>
          <con:property>channel</con:property>
          <con:property>sort</con:property>
          <con:property>StatusCode</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="c3102b50-0478-4a1b-8fb9-8384da882cab">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="bb7ad0d8-15c1-4a9e-a8ea-b7d50e72f307">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 3" resourcePath="/card/${DataSource#cardNumber}/transactions" methodName="Transactions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="874be363-c06a-4af3-b56e-cdb59ace5be1" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="111111"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337804318710200046432/transactions</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="site" value="${DataSource#site}"/>
              <con:entry key="offset" value="${DataSource#offset}"/>
              <con:entry key="limit" value="${DataSource#limit}"/>
              <con:entry key="dateTo" value="${DataSource#dateTo}"/>
              <con:entry key="channel" value="${DataSource#channel}"/>
              <con:entry key="sort" value="${DataSource#sort}"/>
              <con:entry key="dateFrom" value="${DataSource#dateFrom}"/>
              <con:entry key="type" value="${DataSource#type}"/>
              <con:entry key="cardNumber" value="${DataSource#cardNumber}"/>
              <con:entry key="status" value="${DataSource#status}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
              <con:entry>offset</con:entry>
              <con:entry>limit</con:entry>
              <con:entry>dateFrom</con:entry>
              <con:entry>dateTo</con:entry>
              <con:entry>type</con:entry>
              <con:entry>site</con:entry>
              <con:entry>status</con:entry>
              <con:entry>channel</con:entry>
              <con:entry>sort</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="add621ef-7b40-4db3-9099-e878d379eab7">
        <con:settings/>
        <con:config>
          <script>import groovy.json.JsonSlurper

//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//Get the status code value from the Input sheet
def status_Code = context.expand( '${DataSource#StatusCode}' )
 

//Assert actual value to the expected value
if (status.contains(status_Code))
{
return "PASS"
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="c6cae7a7-a57a-4ec6-915f-9633ca01aa73">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>BMO</worksheet>
              <cell>M2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="43d4f08a-0402-4f1d-ae31-2e01153416d7">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bb7ad0d8-15c1-4a9e-a8ea-b7d50e72f307</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="09698c7d-dcdc-4338-87ef-6411ef3e9359" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="ID" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="396ea8e3-9b1a-4044-a05e-d01086085751">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetHistory-cardnumber.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="5638ef43-5153-41f2-8b65-2efd6fe487ec">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>ID</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>cardNumber</con:property>
          <con:property>offset</con:property>
          <con:property>limit</con:property>
          <con:property>dateFrom</con:property>
          <con:property>dateTo</con:property>
          <con:property>type</con:property>
          <con:property>site</con:property>
          <con:property>status</con:property>
          <con:property>channel</con:property>
          <con:property>sort</con:property>
          <con:property>StatusCode</con:property>
          <con:property>ExceptionCode</con:property>
          <con:property>Message</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="ffb8c0b9-aa1a-42ec-88dd-1fa44bc43dcb">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="60cbf641-064d-4690-93cd-639939e60868">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 3" resourcePath="/card/${DataSource#cardNumber}/transactions" methodName="Transactions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="874be363-c06a-4af3-b56e-cdb59ace5be1" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="99999999"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6/transactions</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="site" value="${DataSource#site}"/>
              <con:entry key="offset" value="${DataSource#offset}"/>
              <con:entry key="limit" value="${DataSource#limit}"/>
              <con:entry key="dateTo" value="${DataSource#dateTo}"/>
              <con:entry key="channel" value="${DataSource#channel}"/>
              <con:entry key="sort" value="${DataSource#sort}"/>
              <con:entry key="dateFrom" value="${DataSource#dateFrom}"/>
              <con:entry key="type" value="${DataSource#type}"/>
              <con:entry key="cardNumber" value="${DataSource#cardNumber}"/>
              <con:entry key="status" value="${DataSource#status}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
              <con:entry>offset</con:entry>
              <con:entry>limit</con:entry>
              <con:entry>dateFrom</con:entry>
              <con:entry>dateTo</con:entry>
              <con:entry>type</con:entry>
              <con:entry>site</con:entry>
              <con:entry>status</con:entry>
              <con:entry>channel</con:entry>
              <con:entry>sort</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="349b5edd-74ff-4e35-bb71-d393580c0074">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="e11f6982-5eb1-4318-aee0-ab8c52fdb9f3">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>ID</worksheet>
              <cell>O2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="5fa136a1-a8f0-4c13-8621-eb3416a115df">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bb7ad0d8-15c1-4a9e-a8ea-b7d50e72f307</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="d8af3ac3-342f-4064-9876-09af9a0b6154" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="Headers" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="6e5cf307-84af-47a3-8c36-13aaf481483b">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetHistory-cardnumber.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="f5fbcfe3-4c6c-424c-98cc-9afb135cc02e">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>Headers</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>cardNumber</con:property>
          <con:property>offset</con:property>
          <con:property>limit</con:property>
          <con:property>dateFrom</con:property>
          <con:property>dateTo</con:property>
          <con:property>type</con:property>
          <con:property>site</con:property>
          <con:property>status</con:property>
          <con:property>channel</con:property>
          <con:property>sort</con:property>
          <con:property>X-COSTA-LANG</con:property>
          <con:property>X-COSTA-COUNTRY</con:property>
          <con:property>X-COSTA-CHANNEL</con:property>
          <con:property>X-COSTA-ORGANISATION</con:property>
          <con:property>X-COSTA-API-VERSION</con:property>
          <con:property>client_id</con:property>
          <con:property>client_secret</con:property>
          <con:property>StatusCode</con:property>
          <con:property>ExceptionCode</con:property>
          <con:property>Message</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="d95ab35b-be76-4d0c-abb0-2808a182d793">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="6fdf8d52-f183-483c-b5bd-41808a060651">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 3" resourcePath="/card/${DataSource#cardNumber}/transactions" methodName="Transactions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="874be363-c06a-4af3-b56e-cdb59ace5be1" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="${DataSource#X-COSTA-COUNTRY}"/>
  <con:entry key="X-COSTA-CHANNEL" value="${DataSource#X-COSTA-CHANNEL}"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="111111"/>
  <con:entry key="client_secret" value="${DataSource#client_secret}"/>
  <con:entry key="X-COSTA-LANG" value="${DataSource#X-COSTA-LANG}"/>
  <con:entry key="client_id" value="${DataSource#client_id}"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/6337804318710200046432/transactions</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="site" value="${DataSource#site}"/>
              <con:entry key="offset" value="${DataSource#offset}"/>
              <con:entry key="limit" value="${DataSource#limit}"/>
              <con:entry key="dateTo" value="${DataSource#dateTo}"/>
              <con:entry key="channel" value="${DataSource#channel}"/>
              <con:entry key="sort" value="${DataSource#sort}"/>
              <con:entry key="dateFrom" value="${DataSource#dateFrom}"/>
              <con:entry key="type" value="${DataSource#type}"/>
              <con:entry key="cardNumber" value="${DataSource#cardNumber}"/>
              <con:entry key="status" value="${DataSource#status}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>cardNumber</con:entry>
              <con:entry>offset</con:entry>
              <con:entry>limit</con:entry>
              <con:entry>dateFrom</con:entry>
              <con:entry>dateTo</con:entry>
              <con:entry>type</con:entry>
              <con:entry>site</con:entry>
              <con:entry>status</con:entry>
              <con:entry>channel</con:entry>
              <con:entry>sort</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="3ee05a8a-9d26-4c4d-9e2f-9820acd5e9cc">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="88b2ff43-6227-4aa7-9d46-7e3b45154635">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>Headers</worksheet>
              <cell>V2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="0a0552e9-7614-4e82-a950-7458a55b9582">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bb7ad0d8-15c1-4a9e-a8ea-b7d50e72f307</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:testSuite id="57630a5f-7318-4f06-95b0-f9246a178ef6" name="GetHistoryByEmail">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="5abd4f53-db16-453d-a8fb-e8dd77245760" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="BMO" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="a868f2d2-60ad-4679-8e52-3db0e0961906">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetHistory-email.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="e79df4db-c851-4028-ad9f-304322e29289">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>BMO</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>email</con:property>
          <con:property>offset</con:property>
          <con:property>limit</con:property>
          <con:property>dateFrom</con:property>
          <con:property>dateTo</con:property>
          <con:property>type</con:property>
          <con:property>site</con:property>
          <con:property>status</con:property>
          <con:property>channel</con:property>
          <con:property>sort</con:property>
          <con:property>StatusCode</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="77e8da1c-ff72-4ea7-a67a-8634521d9ab7">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="26c56ee1-3552-414d-9fb4-34a71d89fa8a">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 4" resourcePath="/customer/${DataSource#email}/transactions" methodName="Transactions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="c1ed625e-8c29-4f20-b782-7f3c0b7072c0" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="1111111"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/Alanwestwood4@gmail.com/transactions</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="site" value="${DataSource#site}"/>
              <con:entry key="offset" value="${DataSource#offset}"/>
              <con:entry key="limit" value="${DataSource#limit}"/>
              <con:entry key="dateTo" value="${DataSource#dateTo}"/>
              <con:entry key="channel" value="${DataSource#channel}"/>
              <con:entry key="sort" value="${DataSource#sort}"/>
              <con:entry key="dateFrom" value="${DataSource#dateFrom}"/>
              <con:entry key="type" value="${DataSource#type}"/>
              <con:entry key="email" value="${DataSource#email}"/>
              <con:entry key="status" value="${DataSource#status}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>email</con:entry>
              <con:entry>offset</con:entry>
              <con:entry>limit</con:entry>
              <con:entry>dateFrom</con:entry>
              <con:entry>dateTo</con:entry>
              <con:entry>type</con:entry>
              <con:entry>site</con:entry>
              <con:entry>status</con:entry>
              <con:entry>channel</con:entry>
              <con:entry>sort</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="5c8c4554-d4c0-4abc-a3f6-a8d7d6b20023">
        <con:settings/>
        <con:config>
          <script>import groovy.json.JsonSlurper

//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//Get the status code value from the Input sheet
def status_Code = context.expand( '${DataSource#StatusCode}' )
 
 

//Assert actual value to the expected value
if (status.contains(status_Code))
{
return "PASS"
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="e9e544f2-6e62-4afa-b6bb-7c0d38c7dd13">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>BMO</worksheet>
              <cell>M2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="90817fe6-c83d-40ee-8c53-0db2c47c3601">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bb7ad0d8-15c1-4a9e-a8ea-b7d50e72f307</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>26c56ee1-3552-414d-9fb4-34a71d89fa8a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="b29f4532-baa9-4fb4-9813-f0a5f363a233" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="ID" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="9daef5d9-e0a1-453a-b5d4-d202d8b5c391">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetHistory-email.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="8fe83380-987f-457a-bfe5-e26a530b20a5">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>ID</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>email</con:property>
          <con:property>offset</con:property>
          <con:property>limit</con:property>
          <con:property>dateFrom</con:property>
          <con:property>dateTo</con:property>
          <con:property>type</con:property>
          <con:property>site</con:property>
          <con:property>status</con:property>
          <con:property>channel</con:property>
          <con:property>sort</con:property>
          <con:property>StatusCode</con:property>
          <con:property>ExceptionCode</con:property>
          <con:property>Message</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="3e22d09f-9a9f-4a31-ba26-2c14e729fcbc">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="7e6eb0ea-1532-4d95-9886-518ec181b0eb">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 4" resourcePath="/customer/${DataSource#email}/transactions" methodName="Transactions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="c1ed625e-8c29-4f20-b782-7f3c0b7072c0" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="GB"/>
  <con:entry key="X-COSTA-CHANNEL" value="D"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="9999999999"/>
  <con:entry key="client_secret" value="04e54F5b001649919419CF2fd481314C"/>
  <con:entry key="X-COSTA-LANG" value="en-gb"/>
  <con:entry key="client_id" value="79db5db62a8441278edddac6088d279c"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/transactions</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="site" value="${DataSource#site}"/>
              <con:entry key="offset" value="${DataSource#offset}"/>
              <con:entry key="limit" value="${DataSource#limit}"/>
              <con:entry key="dateTo" value="${DataSource#dateTo}"/>
              <con:entry key="channel" value="${DataSource#channel}"/>
              <con:entry key="sort" value="${DataSource#sort}"/>
              <con:entry key="dateFrom" value="${DataSource#dateFrom}"/>
              <con:entry key="type" value="${DataSource#type}"/>
              <con:entry key="email" value="${DataSource#email}"/>
              <con:entry key="status" value="${DataSource#status}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>email</con:entry>
              <con:entry>offset</con:entry>
              <con:entry>limit</con:entry>
              <con:entry>dateFrom</con:entry>
              <con:entry>dateTo</con:entry>
              <con:entry>type</con:entry>
              <con:entry>site</con:entry>
              <con:entry>status</con:entry>
              <con:entry>channel</con:entry>
              <con:entry>sort</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="0f18f4f0-397b-42e9-bf08-c8e719393658">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="bb632690-3ea4-46ae-be35-05147965469e">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>ID</worksheet>
              <cell>O2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="e0c32aca-9224-4e05-92ac-e4ac00f5d9e1">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bb7ad0d8-15c1-4a9e-a8ea-b7d50e72f307</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>7e6eb0ea-1532-4d95-9886-518ec181b0eb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:testCase id="336b8a12-87e3-48cd-8634-8774149481ac" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="Headers" searchProperties="true" timeout="0" maxResults="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" zephyrTestName="" zephyrTestId="">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="ea56f54e-170f-4848-8909-c40f927566e6">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\GetHistory-email.xlsx</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="00ea393a-6953-4ff3-b172-0aecd82340cc">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>Headers</worksheet>
              <cell>A2</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>true</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>TestCase ID</con:property>
          <con:property>email</con:property>
          <con:property>offset</con:property>
          <con:property>limit</con:property>
          <con:property>dateFrom</con:property>
          <con:property>dateTo</con:property>
          <con:property>type</con:property>
          <con:property>site</con:property>
          <con:property>status</con:property>
          <con:property>channel</con:property>
          <con:property>sort</con:property>
          <con:property>X-COSTA-LANG</con:property>
          <con:property>X-COSTA-COUNTRY</con:property>
          <con:property>X-COSTA-CHANNEL</con:property>
          <con:property>X-COSTA-ORGANISATION</con:property>
          <con:property>X-COSTA-API-VERSION</con:property>
          <con:property>client_id</con:property>
          <con:property>client_secret</con:property>
          <con:property>StatusCode</con:property>
          <con:property>ExceptionCode</con:property>
          <con:property>Message</con:property>
          <con:property>X-COSTA-EXT-CORRELATION-ID</con:property>
          <con:property>Request</con:property>
          <con:property>Response</con:property>
          <con:property>Result</con:property>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="TransactionID" id="c9536034-74c7-465a-ba66-eb60a49062a4">
        <con:settings/>
        <con:config>
          <script>//Generate random UUID	

def verCode = UUID.randomUUID().toString() 
return  verCode

log.info verCode</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="4e18d76e-58c9-4e09-bed8-83d2fc932c83">
        <con:settings/>
        <con:config service="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 4" resourcePath="/customer/${DataSource#email}/transactions" methodName="Transactions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="c1ed625e-8c29-4f20-b782-7f3c0b7072c0" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="X-COSTA-COUNTRY" value="${DataSource#X-COSTA-COUNTRY}"/>
  <con:entry key="X-COSTA-CHANNEL" value="${DataSource#X-COSTA-CHANNEL}"/>
  <con:entry key="X-COSTA-TRANSACTION-ID" value="${TransactionID#result}"/>
  <con:entry key="X-COSTA-EXT-CORRELATION-ID" value="99999998"/>
  <con:entry key="client_secret" value="${DataSource#client_secret}"/>
  <con:entry key="X-COSTA-LANG" value="${DataSource#X-COSTA-LANG}"/>
  <con:entry key="client_id" value="${DataSource#client_id}"/>
</xml-fragment>]]></con:setting>
            </con:settings>
            <con:endpoint>https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
            <con:request/>
            <con:originalUri>https://x-crm-api-v1-dev.ir-e1.cloudhub.io/card/transactions</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters>
              <con:entry key="site" value="${DataSource#site}"/>
              <con:entry key="offset" value="${DataSource#offset}"/>
              <con:entry key="limit" value="${DataSource#limit}"/>
              <con:entry key="dateTo" value="${DataSource#dateTo}"/>
              <con:entry key="channel" value="${DataSource#channel}"/>
              <con:entry key="sort" value="${DataSource#sort}"/>
              <con:entry key="dateFrom" value="${DataSource#dateFrom}"/>
              <con:entry key="type" value="${DataSource#type}"/>
              <con:entry key="email" value="${DataSource#email}"/>
              <con:entry key="status" value="${DataSource#status}"/>
            </con:parameters>
            <con:parameterOrder>
              <con:entry>email</con:entry>
              <con:entry>offset</con:entry>
              <con:entry>limit</con:entry>
              <con:entry>dateFrom</con:entry>
              <con:entry>dateTo</con:entry>
              <con:entry>type</con:entry>
              <con:entry>site</con:entry>
              <con:entry>status</con:entry>
              <con:entry>channel</con:entry>
              <con:entry>sort</con:entry>
            </con:parameterOrder>
            <con:environmentSpec>
              <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
                <con:authProfile>Inherit From Parent</con:authProfile>
              </con:entry>
            </con:environmentSpec>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="Responsevalidation" id="36492368-2c4e-4972-9e1f-a19e544b62dd">
        <con:settings/>
        <con:config>
          <script>//Fetch the raw headers from the response
def httpValue = testRunner.testCase.testSteps['Request'].testRequest.response.getResponseHeaders()
log.info httpValue
def status = httpValue["#status#"].toString()
log.info status

//expected test result

def expected_exceptionCode =  context.expand( '${DataSource#Exception Code}' )

log.info expected_exceptionCode
def expected_message = context.expand( '${DataSource#message}' )
log.info expected_message

//Actual test result

def response_exception_code = context.expand( '${Request#Response#$[\'exception\'][\'exceptionCode\']}' )
log.info response_exception_code
def responsemessage = context.expand( '${Request#Response#$[\'exception\'][\'message\']}' )
log.info responsemessage

def status_Code = context.expand( '${DataSource#StatusCode}' )
if (status.contains(status_Code))
{
    if(response_exception_code.contains(expected_exceptionCode) &amp;&amp; responsemessage.contains(expected_message) )
{
return "PASS"
}
else
{
return "FAIL"
}
}
else
{
return "FAIL"
}</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="040c85d1-b104-4dc1-88fb-6a0378ba9cd3">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file/>
              <outfile>${Properties#Source}</outfile>
              <worksheet>Headers</worksheet>
              <cell>V2</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>X-COSTA-EXT-CORRELATION-ID</con:name>
              <con:value>${TransactionID#result}</con:value>
            </con:property>
            <con:property>
              <con:name>Request</con:name>
              <con:value>${Request#RawRequest}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${Request#RawResponse}</con:value>
            </con:property>
            <con:property>
              <con:name>Result</con:name>
              <con:value>${Responsevalidation#result}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="d4b499dd-8f1c-4903-920e-f3f3d3b4d8df">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>TransactionID</targetStep>
          <discardResults>true</discardResults>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>5ea4c875-1386-402c-a7ff-f18f49c7414f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6b3ad994-aed8-4077-9e95-e050a8a7d0cf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>9c885f00-8bb0-4045-b388-81e8f807c262</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>b455f0b8-11f6-4cb1-948b-bf4ad98ba351</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>500934ce-6fd9-4eef-b494-fbd7651282e0</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ba7dadda-645f-40b9-b86c-d0c113a00edf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bb7ad0d8-15c1-4a9e-a8ea-b7d50e72f307</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>4e18d76e-58c9-4e09-bed8-83d2fc932c83</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:environmentSpec>
        <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
          <con:authProfile>Inherit From Parent</con:authProfile>
        </con:entry>
      </con:environmentSpec>
    </con:testCase>
    <con:properties/>
    <con:reportParameters/>
    <con:environmentSpec>
      <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
        <con:authProfile>Inherit From Parent</con:authProfile>
      </con:entry>
    </con:environmentSpec>
  </con:testSuite>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:requirements/>
  <con:properties/>
  <con:wssContainer/>
  <con:databaseConnectionContainer/>
  <con:jmsConnectionContainer/>
  <con:oAuth2ProfileContainer/>
  <con:oAuth1ProfileContainer/>
  <con:reporting>
    <con:xmlTemplates/>
    <con:parameters/>
  </con:reporting>
  <con:eventHandlers type="RequestFilter.filterRequest" name="RequestFilter.filterRequest">
    <con:script>// Sample event script to add custom HTTP header to all outgoing REST, SOAP and HTTP(S) calls
// This code is often used for adding custom authentication to SoapUI Pro tests

// If hardcoding the token, uncomment and change line 5
// def token = '4567'

// If your token is parameterized in Project level custom property, uncomment line 8
// def token = request.parent.testCase.testSuite.project.getProperty('auth_token').getValue()

// To modify all outgoing calls, remove comments from lines 11 to 16
// def headers = request.requestHeaders
// if (headers.containsKey('auth_token2') == false) {
//   headers.put('auth_token2', token)
//   request.requestHeaders = headers
// }</con:script>
  </con:eventHandlers>
  <con:eventHandlers type="TestRunListener.afterStep" name="TestRunListener.afterStep">
    <con:script>// Save all test step results into files
// Change the directory path in line 5 to a location where you want to store details
// then uncomment lines 5 to 10

// filePath = 'C:\\tempOutputDirectory\\'
// fos = new FileOutputStream(filePath + testStepResult.testStep.label + '.txt', true)
// pw = new PrintWriter(fos)
// testStepResult.writeTo(pw)
// pw.close()
// fos.close()</con:script>
  </con:eventHandlers>
  <con:sensitiveInformation/>
  <con:environment id="38ed5fcc-60bb-497f-9d02-3a243eb8601f" name="dev">
    <con:service type="REST" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io">
      <con:endpoint authProfile="No Authorization" proxyHost="" proxyPort="" proxyUsername="" proxyPassword="">https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:service>
    <con:service type="REST" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 1">
      <con:endpoint authProfile="No Authorization">https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:service>
    <con:service type="REST" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 2">
      <con:endpoint authProfile="No Authorization">https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:service>
    <con:service type="REST" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 3">
      <con:endpoint authProfile="No Authorization">https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:service>
    <con:service type="REST" name="https://x-crm-api-v1-dev.ir-e1.cloudhub.io 4">
      <con:endpoint authProfile="No Authorization">https://x-crm-api-v1-dev.ir-e1.cloudhub.io</con:endpoint>
    </con:service>
    <con:databaseConnectionContainer/>
    <con:jmsConnectionContainer/>
  </con:environment>
  <con:authRepository/>
  <con:environmentSpec>
    <con:entry environmentId="38ed5fcc-60bb-497f-9d02-3a243eb8601f">
      <con:authProfile>No Authorization</con:authProfile>
    </con:entry>
  </con:environmentSpec>
  <con:tags/>
</con:soapui-project>
